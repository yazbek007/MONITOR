<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸš€ Ù…Ù†ØµØ© Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…ØªÙ‚Ø¯Ù… â€“ Ø¹Ø±Ø¶ Ù…ÙˆØ³Ø¹ Ù„Ù„Ø¹Ù…Ù„Ø§Øª</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.3.0/build/global/luxon.min.js"></script>
    <style>
        /* ========== Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© (ÙƒÙ…Ø§ Ù‡ÙŠ Ù…Ø¹ ØªØ­Ø³ÙŠÙ†Ø§Øª) ========== */
        :root {
            --primary: #2E86AB;
            --secondary: #A23B72;
            --success: #3BB273;
            --warning: #F18F01;
            --danger: #C73E1D;
            --info: #2E86AB;
            --dark: #1A1A2E;
            --light: #F8F9FA;
            --gray: #6C757D;
            --purple: #6A4C93;
            --teal: #20B2AA;
            --card-bg: #ffffff;
            --body-bg: #f5f7fb;
            --border-radius: 12px;
            --shadow: 0 8px 20px rgba(0, 0, 0, 0.05);
            --shadow-hover: 0 15px 30px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Cairo', sans-serif;
        }

        body {
            background-color: var(--body-bg);
            color: #333;
            line-height: 1.6;
            padding-bottom: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* ========== Ø§Ù„Ù‡ÙŠØ¯Ø± ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ========== */
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary), var(--purple));
            color: white;
            padding: 25px 0;
            border-radius: var(--border-radius);
            margin: 20px 0 30px;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }
        header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
            background-size: 20px 20px;
            opacity: 0.1;
        }
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 30px;
            position: relative;
            z-index: 1;
        }
        .logo { display: flex; align-items: center; gap: 15px; }
        .logo i { font-size: 2.5rem; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
        .logo h1 { font-size: 1.8rem; font-weight: 700; text-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        .version { font-size: 0.8rem; background: rgba(255,255,255,0.2); padding: 2px 8px; border-radius: 10px; margin-right: 10px; }
        
        /* Ø²Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø­Ø³Ù‘Ù† */
        .update-btn {
            background: white; 
            color: var(--primary); 
            border: none; 
            padding: 12px 25px; 
            border-radius: 50px;
            font-weight: 600; 
            cursor: pointer; 
            transition: var(--transition); 
            display: flex; 
            align-items: center; 
            gap: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            position: relative;
        }
        .update-btn:hover:not(:disabled) { 
            transform: translateY(-3px); 
            box-shadow: var(--shadow-hover); 
        }
        .update-btn:disabled { 
            opacity: 0.7; 
            cursor: not-allowed; 
            transform: none; 
        }
        .update-btn.loading {
            opacity: 0.9;
            cursor: wait;
        }
        .update-btn.loading i {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            100% { transform: rotate(360deg); }
        }

        /* ØªÙˆØµÙŠØ© Ø§Ù„ØªØ­Ø¯ÙŠØ« */
        .update-recommendation {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: rgba(255,255,255,0.2);
            padding: 6px 15px;
            border-radius: 50px;
            font-size: 0.85rem;
            color: white;
            margin-right: 15px;
            animation: pulse-warning 1.5s infinite;
        }
        @keyframes pulse-warning {
            0% { opacity: 0.8; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.02); }
            100% { opacity: 0.8; transform: scale(1); }
        }

        /* Ù…Ø¤Ø´Ø± Ù†Ø¶Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª */
        .freshness-dot {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-left: 8px;
            vertical-align: middle;
            box-shadow: 0 0 8px rgba(0,0,0,0.2);
            transition: background 0.3s;
        }
        .freshness-dot.recent { background: #28a745; }
        .freshness-dot.stale { background: #ffc107; }
        .freshness-dot.very-stale { background: #dc3545; }

        /* Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø£Ù†Ù…Ø§Ø· ÙƒÙ…Ø§ Ù‡ÙŠ Ø¯ÙˆÙ† ØªØºÙŠÙŠØ± Ø¬ÙˆÙ‡Ø±ÙŠ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        .stat-card {
            background: white; padding: 20px; border-radius: var(--border-radius); text-align: center;
            box-shadow: var(--shadow); transition: var(--transition); border-top: 4px solid var(--gray);
        }
        .stat-card:hover { transform: translateY(-3px); box-shadow: var(--shadow-hover); }
        .stat-card.strong-buy { border-top-color: var(--success); }
        .stat-card.buy { border-top-color: var(--primary); }
        .stat-card.neutral { border-top-color: var(--gray); }
        .stat-card.sell { border-top-color: var(--warning); }
        .stat-card.strong-sell { border-top-color: var(--danger); }
        .stat-card.avg { border-top-color: var(--secondary); }
        .stat-card i { font-size: 1.8rem; margin-bottom: 10px; }
        .stat-card h3 { font-size: 1.8rem; color: var(--dark); margin: 10px 0; font-weight: 700; }
        .stat-card p { color: var(--gray); font-size: 0.85rem; }

        .market-info {
            background: white; padding: 20px; border-radius: var(--border-radius); box-shadow: var(--shadow); margin-bottom: 25px;
        }
        .market-info-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;
        }
        .market-info-item {
            text-align: center; padding: 15px; background: #f8f9fa; border-radius: 8px;
        }
        .market-info-item h4 { color: var(--gray); font-size: 0.9rem; margin-bottom: 8px; display: flex; align-items: center; justify-content: center; gap: 5px; }
        .market-info-item p { color: var(--dark); font-weight: 600; font-size: 1.2rem; }

        .fear-greed-indicator {
            background: white; padding: 20px; border-radius: var(--border-radius); box-shadow: var(--shadow); margin-bottom: 25px;
        }
        .fgi-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .fgi-title { font-size: 1.1rem; color: var(--dark); display: flex; align-items: center; gap: 10px; }
        .fgi-value { font-size: 1.5rem; font-weight: 700; color: var(--dark); }
        .fgi-bar {
            height: 25px; background: linear-gradient(to right, #ff4444 0%, #ffbb33 25%, #ffff44 50%, #99ff99 75%, #00C851 100%);
            border-radius: 12px; position: relative; margin: 15px 0; overflow: hidden;
        }
        .fgi-marker {
            position: absolute; top: -5px; width: 2px; height: 35px; background: white; transform: translateX(-50%);
        }
        .fgi-labels { display: flex; justify-content: space-between; font-size: 0.8rem; color: var(--gray); }

        .update-timer {
            background: white; padding: 15px; border-radius: var(--border-radius); margin-bottom: 20px;
            display: flex; justify-content: space-between; align-items: center; box-shadow: var(--shadow);
        }
        .timer-display { font-weight: 600; font-size: 1.1rem; color: var(--primary); }

        /* Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø£Ù†Ù…Ø§Ø· (Ø§Ù„Ø¬Ø¯ÙˆÙ„ØŒ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§ØªØŒ Ø§Ù„Ø´Ø§Ø±Øª) ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ */
        .coins-table-section { background: white; border-radius: var(--border-radius); box-shadow: var(--shadow); padding: 20px; margin-bottom: 30px; }
        .table-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 15px; }
        .table-header h2 { display: flex; align-items: center; gap: 10px; color: var(--dark); font-size: 1.4rem; }
        .table-controls { display: flex; gap: 15px; align-items: center; flex-wrap: wrap; }
        .search-box { display: flex; align-items: center; background: #f8f9fa; border-radius: 50px; padding: 5px 15px; border: 1px solid #eaeaea; }
        .search-box i { color: var(--gray); margin-left: 10px; }
        .search-box input { border: none; background: transparent; padding: 8px 0; font-size: 0.95rem; width: 200px; outline: none; }
        .filter-select { padding: 8px 15px; border-radius: 50px; border: 1px solid #eaeaea; background: #f8f9fa; font-family: 'Cairo'; outline: none; }
        .per-page-select { padding: 8px 15px; border-radius: 50px; border: 1px solid #eaeaea; background: #f8f9fa; font-family: 'Cairo'; outline: none; }
        .table-responsive { overflow-x: auto; margin-bottom: 20px; }
        table { width: 100%; border-collapse: collapse; font-size: 0.9rem; }
        th { background: #f8f9fa; color: var(--dark); padding: 15px 10px; font-weight: 600; white-space: nowrap; cursor: pointer; user-select: none; transition: background 0.2s; }
        th:hover { background: #e9ecef; }
        td { padding: 12px 10px; border-bottom: 1px solid #f0f0f0; vertical-align: middle; }
        tr:hover { background: #fafafa; }
        .coin-symbol { display: flex; align-items: center; gap: 8px; font-weight: 600; color: var(--dark); }
        .coin-icon { width: 32px; height: 32px; background: linear-gradient(135deg, var(--primary), var(--secondary)); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 0.8rem; font-weight: bold; }
        .price { font-weight: 600; color: var(--dark); }
        .change { font-weight: 600; padding: 4px 8px; border-radius: 10px; display: inline-block; }
        .change.positive { background: rgba(59, 178, 115, 0.1); color: var(--success); }
        .change.negative { background: rgba(199, 62, 29, 0.1); color: var(--danger); }
        .change.neutral { background: rgba(108, 117, 125, 0.1); color: var(--gray); }
        .signal-badge { padding: 6px 12px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; display: inline-block; white-space: nowrap; }
        .signal-success { background: rgba(59, 178, 115, 0.2); color: var(--success); border: 1px solid rgba(59,178,115,0.3); }
        .signal-primary { background: rgba(46, 134, 171, 0.2); color: var(--primary); border: 1px solid rgba(46,134,171,0.3); }
        .signal-gray { background: rgba(108, 117, 125, 0.2); color: var(--gray); border: 1px solid rgba(108,117,125,0.3); }
        .signal-warning { background: rgba(241, 143, 1, 0.2); color: var(--warning); border: 1px solid rgba(241,143,1,0.3); }
        .signal-danger { background: rgba(199, 62, 29, 0.2); color: var(--danger); border: 1px solid rgba(199,62,29,0.3); }
        .progress { width: 80px; height: 8px; background: #e9ecef; border-radius: 4px; overflow: hidden; display: inline-block; margin-left: 8px; }
        .progress-bar { height: 100%; border-radius: 4px; }
        .action-btn { padding: 6px 12px; border-radius: 20px; border: none; background: var(--primary); color: white; font-size: 0.75rem; display: inline-flex; align-items: center; gap: 5px; cursor: pointer; transition: var(--transition); }
        .action-btn:hover { background: var(--secondary); transform: scale(1.05); }
        .pagination { display: flex; justify-content: center; align-items: center; gap: 10px; margin-top: 20px; flex-wrap: wrap; }
        .page-btn { padding: 8px 14px; border-radius: 8px; border: 1px solid #eaeaea; background: white; cursor: pointer; transition: var(--transition); }
        .page-btn:hover { background: var(--primary); color: white; border-color: var(--primary); }
        .page-btn.active { background: var(--primary); color: white; border-color: var(--primary); }
        .page-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); backdrop-filter: blur(5px); display: flex; align-items: center; justify-content: center; z-index: 2000; opacity: 0; visibility: hidden; transition: opacity 0.3s, visibility 0.3s; }
        .modal.show { opacity: 1; visibility: visible; }
        .modal-content { background: white; width: 90%; max-width: 700px; max-height: 90vh; overflow-y: auto; border-radius: var(--border-radius); padding: 30px; position: relative; box-shadow: 0 20px 40px rgba(0,0,0,0.2); }
        .modal-close { position: absolute; top: 20px; left: 20px; background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--gray); }
        .modal-close:hover { color: var(--danger); }
        .notifications-card { background: white; border-radius: var(--border-radius); padding: 20px; box-shadow: var(--shadow); }
        .notifications-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid #f0f0f0; }
        .notifications-title { font-size: 1.2rem; color: var(--dark); display: flex; align-items: center; gap: 10px; }
        .notification-badge { background: var(--danger); color: white; border-radius: 50%; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; }
        .notifications-list { max-height: 400px; overflow-y: auto; padding-right: 10px; }
        .notification-item { padding: 15px; border-right: 4px solid var(--primary); background: #f8f9fa; margin-bottom: 10px; border-radius: 0 8px 8px 0; transition: var(--transition); }
        .notification-item:hover { background: #e9ecef; transform: translateX(-5px); }
        .notification-item.strong_buy { border-right-color: var(--success); }
        .notification-item.buy { border-right-color: var(--primary); }
        .notification-item.strong_sell { border-right-color: var(--danger); }
        .notification-item.sell { border-right-color: var(--warning); }
        .chart-card { background: white; border-radius: var(--border-radius); padding: 20px; box-shadow: var(--shadow); margin-bottom: 30px; }
        .chart-container { height: 300px; margin-top: 15px; position: relative; }
        footer { text-align: center; padding: 20px; color: var(--gray); font-size: 0.9rem; margin-top: 40px; border-top: 1px solid #eaeaea; }
        .disclaimer { background: rgba(241, 143, 1, 0.1); padding: 15px; border-radius: 8px; margin-top: 15px; border-right: 4px solid var(--warning); }
        @media (max-width: 1200px) { .main-content { grid-template-columns: 1fr; } }
        @media (max-width: 768px) { 
            .header-content { flex-direction: column; gap: 20px; text-align: center; } 
            .stats-grid { grid-template-columns: repeat(2, 1fr); } 
            .market-info-grid { grid-template-columns: 1fr; } 
            .table-header { flex-direction: column; align-items: flex-start; } 
            .search-box input { width: 150px; } 
        }
        @media (max-width: 480px) { .stats-grid { grid-template-columns: 1fr; } }
        .legend { display: flex; justify-content: center; gap: 15px; margin: 20px 0; flex-wrap: wrap; }
        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.8rem; padding: 5px 10px; background: white; border-radius: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .legend-color { width: 12px; height: 12px; border-radius: 50%; }
    </style>
</head>
<body>
    <div class="container">
        <!-- ========== Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ù…Ø­Ø³Ù‘Ù† ========== -->
        <header>
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-chart-line"></i>
                    <div>
                        <h1><span class="version">v3.5</span> ğŸš€ Ù…Ø­Ù„Ù„ Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Øª â€“ Ø¹Ø±Ø¶ Ù…ÙˆØ³Ø¹</h1>
                        <div class="system-status">
                            <span>Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…: {{ stats.system_status }}</span>
                        </div>
                    </div>
                </div>
                <div style="display: flex; align-items: center; gap: 20px;">
                    <div class="status {{ stats.system_status }}">
                        <i class="fas fa-sync-alt"></i>
                        <span id="last-update-text">{{ stats.last_update_str or 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...' }}</span>
                        <!-- Ù†Ù‚Ø·Ø© Ù†Ø¶Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
                        <span class="freshness-dot" id="freshnessDot"></span>
                        <!-- Ø±Ø³Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« Ù…Ø³ØªØ­Ù‚ (ØªØ¸Ù‡Ø± Ø¹Ù†Ø¯ Ù‚Ø¯Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª) -->
                        <span id="staleWarning" style="color: #ffcccc; font-size: 0.8rem; margin-right: 8px; display: none;">ØªØ­Ø¯ÙŠØ« Ù…Ø³ØªØ­Ù‚!</span>
                    </div>
                    <button class="update-btn" onclick="manualUpdate()" id="updateBtn">
                        <i class="fas fa-redo"></i> ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¢Ù†
                    </button>
                    <!-- ØªÙˆØµÙŠØ© Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø°ÙƒÙŠØ© -->
                    <span id="updateRecommendation" class="update-recommendation" style="display: none;">
                        <i class="fas fa-exclamation-triangle" style="color: var(--warning);"></i> ÙŠÙˆØµÙ‰ Ø¨Ø§Ù„ØªØ­Ø¯ÙŠØ«
                    </span>
                </div>
            </div>
        </header>

        <!-- ========== ÙˆØ³ÙŠÙ„Ø© Ø§Ù„Ø¥ÙŠØ¶Ø§Ø­ (ÙƒÙ…Ø§ Ù‡ÙŠ) ========== -->
        <div class="legend">
            <div class="legend-item"><div class="legend-color" style="background: var(--success);"></div> Ø´Ø±Ø§Ø¡ Ù‚ÙˆÙŠ (â‰¥78%)</div>
            <div class="legend-item"><div class="legend-color" style="background: var(--primary);"></div> Ø´Ø±Ø§Ø¡ (62-77%)</div>
            <div class="legend-item"><div class="legend-color" style="background: var(--gray);"></div> Ù…Ø­Ø§ÙŠØ¯ (45-61%)</div>
            <div class="legend-item"><div class="legend-color" style="background: var(--warning);"></div> Ø¨ÙŠØ¹ (23-44%)</div>
            <div class="legend-item"><div class="legend-color" style="background: var(--danger);"></div> Ø¨ÙŠØ¹ Ù‚ÙˆÙŠ (â‰¤22%)</div>
        </div>

        <!-- ========== Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ========== -->
        <div class="stats-grid">
            <div class="stat-card strong-buy">
                <i class="fas fa-rocket" style="color: var(--success);"></i>
                <h3>{{ stats.strong_buy_signals }}</h3>
                <p>Ø´Ø±Ø§Ø¡ Ù‚ÙˆÙŠ</p>
            </div>
            <div class="stat-card buy">
                <i class="fas fa-arrow-up" style="color: var(--primary);"></i>
                <h3>{{ stats.buy_signals }}</h3>
                <p>Ø´Ø±Ø§Ø¡</p>
            </div>
            <div class="stat-card neutral">
                <i class="fas fa-minus" style="color: var(--gray);"></i>
                <h3>{{ stats.neutral_signals }}</h3>
                <p>Ù…Ø­Ø§ÙŠØ¯</p>
            </div>
            <div class="stat-card sell">
                <i class="fas fa-arrow-down" style="color: var(--warning);"></i>
                <h3>{{ stats.sell_signals }}</h3>
                <p>Ø¨ÙŠØ¹</p>
            </div>
            <div class="stat-card strong-sell">
                <i class="fas fa-skull-crossbones" style="color: var(--danger);"></i>
                <h3>{{ stats.strong_sell_signals }}</h3>
                <p>Ø¨ÙŠØ¹ Ù‚ÙˆÙŠ</p>
            </div>
            <div class="stat-card avg">
                <i class="fas fa-signal" style="color: var(--secondary);"></i>
                <h3>{{ "%.1f"|format(stats.avg_signal) }}%</h3>
                <p>Ù…ØªÙˆØ³Ø· Ø§Ù„Ù‚ÙˆØ©</p>
            </div>
        </div>

        <!-- ========== Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø³ÙˆÙ‚ + Ù…Ø¤Ø´Ø± Ø§Ù„Ø®ÙˆÙ (ÙƒÙ…Ø§ Ù‡ÙŠ) ========== -->
        <div class="market-info">
            <div class="market-info-grid">
                <div class="market-info-item"><h4><i class="fas fa-coins"></i> Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ù…Ù„Ø§Øª</h4><p>{{ stats.total_coins }}</p></div>
                <div class="market-info-item"><h4><i class="fas fa-check-circle"></i> Ø§Ù„Ù…Ø­Ø¯Ø«Ø©</h4><p>{{ stats.updated_coins }}</p></div>
                <div class="market-info-item"><h4><i class="fas fa-bell"></i> Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</h4><p>{{ stats.total_notifications }}</p></div>
                <div class="market-info-item"><h4><i class="fas fa-cogs"></i> Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª</h4><p>{{ indicator_weights|length }}</p></div>
            </div>
        </div>

        <div class="fear-greed-indicator">
            <div class="fgi-header">
                <div class="fgi-title"><i class="fas fa-brain"></i> Ù…Ø¤Ø´Ø± Ø§Ù„Ø®ÙˆÙ ÙˆØ§Ù„Ø¬Ø´Ø¹</div>
                <div class="fgi-value">
                    {{ stats.fear_greed_index }}
                    <small style="font-size: 0.8rem; color: var(--gray);">
                        {% if stats.fear_greed_index >= 70 %}(Ø¬Ø´Ø¹ Ø´Ø¯ÙŠØ¯)
                        {% elif stats.fear_greed_index >= 55 %}(Ø¬Ø´Ø¹)
                        {% elif stats.fear_greed_index >= 45 %}(Ù…Ø­Ø§ÙŠØ¯)
                        {% elif stats.fear_greed_index >= 30 %}(Ø®ÙˆÙ)
                        {% else %}(Ø®ÙˆÙ Ø´Ø¯ÙŠØ¯){% endif %}
                    </small>
                </div>
            </div>
            <div class="fgi-bar">
                <div class="fgi-marker" id="fgi-marker" style="left: {{ stats.fear_greed_index }}%;"></div>
            </div>
            <div class="fgi-labels">
                <span>Ø®ÙˆÙ Ø´Ø¯ÙŠØ¯</span> <span>Ø®ÙˆÙ</span> <span>Ù…Ø­Ø§ÙŠØ¯</span> <span>Ø¬Ø´Ø¹</span> <span>Ø¬Ø´Ø¹ Ø´Ø¯ÙŠØ¯</span>
            </div>
        </div>

        <!-- ========== Ù…Ø¤Ù‚Øª Ø§Ù„ØªØ­Ø¯ÙŠØ« ========== -->
        <div class="update-timer">
            <div><i class="fas fa-info-circle" style="color: var(--primary);"></i> <span style="margin-right: 10px;">Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª</span></div>
            <div class="timer-display" id="update-timer">Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ§Ù„ÙŠ Ø®Ù„Ø§Ù„: 3:00</div>
        </div>

        <!-- ========== Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Øª (Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ù…Ø­Ø³Ù†) ========== -->
        <div class="coins-table-section">
            <div class="table-header">
                <h2><i class="fas fa-table"></i> Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Øª â€“ ØªØ­Ù„ÙŠÙ„ ÙÙˆØ±ÙŠ</h2>
                <div class="table-controls">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="searchInput" placeholder="Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ø±Ù…Ø²..." onkeyup="filterTable()">
                    </div>
                    <select id="signalFilter" class="filter-select" onchange="filterTable()">
                        <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª</option>
                        <option value="strong_buy">Ø´Ø±Ø§Ø¡ Ù‚ÙˆÙŠ</option>
                        <option value="buy">Ø´Ø±Ø§Ø¡</option>
                        <option value="neutral">Ù…Ø­Ø§ÙŠØ¯</option>
                        <option value="sell">Ø¨ÙŠØ¹</option>
                        <option value="strong_sell">Ø¨ÙŠØ¹ Ù‚ÙˆÙŠ</option>
                    </select>
                    <select id="perPageSelect" class="per-page-select" onchange="changePerPage()">
                        <option value="10">10 Ø¹Ù…Ù„Ø§Øª</option>
                        <option value="25" selected>25 Ø¹Ù…Ù„Ø©</option>
                        <option value="50">50 Ø¹Ù…Ù„Ø©</option>
                        <option value="100">100 Ø¹Ù…Ù„Ø©</option>
                    </select>
                </div>
            </div>

            <div class="table-responsive">
                <table id="coinsTable">
                    <thead>
                        <tr>
                            <th onclick="sortTable(0)">#</th>
                            <th onclick="sortTable(1)">Ø§Ù„Ø¹Ù…Ù„Ø©</th>
                            <th onclick="sortTable(2)">Ø§Ù„Ø§Ø³Ù…</th>
                            <th onclick="sortTable(3)">Ø§Ù„Ø³Ø¹Ø± (USDT)</th>
                            <th onclick="sortTable(4)">24h%</th>
                            <th onclick="sortTable(5)">Ø§Ù„Ø¥Ø´Ø§Ø±Ø©</th>
                            <th onclick="sortTable(6)">Ø§Ù„Ù‚ÙˆØ©</th>
                            <th>Ø§Ù„ØªÙØ§ØµÙŠÙ„</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        {% for coin in coins %}
                        <tr>
                            <td>{{ loop.index }}</td>
                            <td>
                                <div class="coin-symbol">
                                    <div class="coin-icon">{{ coin.symbol[:1] }}</div>
                                    {{ coin.symbol }}
                                </div>
                            </td>
                            <td>{{ coin.name }}</td>
                            <td class="price">${{ coin.formatted_price }}</td>
                            <td>
                                <span class="change {{ 'positive' if coin.price_change_24h > 0 else 'negative' if coin.price_change_24h < 0 else 'neutral' }}">
                                    <i class="fas fa-{{ 'arrow-up' if coin.price_change_24h > 0 else 'arrow-down' if coin.price_change_24h < 0 else 'minus' }}"></i>
                                    {{ coin.formatted_24h_change or '0.00%' }}
                                </span>
                            </td>
                            <td>
                                <span class="signal-badge signal-{{ coin.signal_color }}">{{ coin.signal_type }}</span>
                            </td>
                            <td>
                                <span style="font-weight: 600; color: var(--dark);">{{ "%.1f"|format(coin.total_percentage) }}%</span>
                                <div class="progress">
                                    <div class="progress-bar" 
                                    style="width: {{ coin.total_percentage }}%; 
                                           background: {% if coin.signal_color == 'success' %}var(--success){% elif coin.signal_color == 'primary' %}var(--primary){% elif coin.signal_color == 'secondary' or coin.signal_color == 'gray' %}var(--gray){% elif coin.signal_color == 'warning' %}var(--warning){% else %}var(--danger){% endif %};">
                                    </div>
                                </div>
                            </td>
                            <td>
                                <button class="action-btn" onclick="showCoinDetails('{{ coin.symbol }}')">
                                    <i class="fas fa-chart-pie"></i> ØªØ­Ù„ÙŠÙ„
                                </button>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            <!-- ========== Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ØµÙØ­Ø§Øª ========== -->
            <div class="pagination" id="pagination"></div>
            <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px; color: var(--gray);">
                <span id="showing-info"></span>
                <span id="total-coins-info">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ù…Ù„Ø§Øª: {{ coins|length }}</span>
            </div>
        </div>

        <!-- ========== Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ© ========== -->
        <div class="chart-card">
            <h2 style="color: var(--dark); margin-bottom: 15px;"><i class="fas fa-chart-line"></i> ØªØ·ÙˆØ± Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª (Ø¢Ø®Ø± 20 ØªØ­Ø¯ÙŠØ«)</h2>
            <div class="chart-container">
                <canvas id="signalChart"></canvas>
            </div>
        </div>

        <!-- ========== Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø£ÙŠÙ…Ù†: Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ÙˆØ§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ========== -->
        <div style="display: grid; grid-template-columns: 1fr 350px; gap: 25px; margin-top: 30px;">
            <!-- Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª -->
            <div class="notifications-card">
                <div class="notifications-header">
                    <div class="notifications-title">
                        <i class="fas fa-bell"></i> Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø£Ø®ÙŠØ±Ø©
                        {% if stats.total_notifications > 0 %}
                        <span class="notification-badge">{{ stats.total_notifications }}</span>
                        {% endif %}
                    </div>
                    <button class="update-btn" onclick="refreshNotifications()" style="padding: 8px 15px; font-size: 0.9rem;">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
                <div class="notifications-list">
                    {% if notifications %}
                        {% for notification in notifications %}
                        <div class="notification-item {{ notification.notification_type }}">
                            <div style="display: flex; align-items: flex-start; gap: 10px;">
                                <div style="font-size: 1.2rem;">
                                    {% if notification.notification_type == 'strong_buy' %}<i class="fas fa-rocket" style="color: var(--success);"></i>
                                    {% elif notification.notification_type == 'buy' %}<i class="fas fa-arrow-up" style="color: var(--primary);"></i>
                                    {% elif notification.notification_type == 'strong_sell' %}<i class="fas fa-skull-crossbones" style="color: var(--danger);"></i>
                                    {% elif notification.notification_type == 'sell' %}<i class="fas fa-arrow-down" style="color: var(--warning);"></i>
                                    {% else %}<i class="fas fa-exchange-alt" style="color: var(--secondary);"></i>{% endif %}
                                </div>
                                <div style="flex: 1;">
                                    <div style="margin-bottom: 5px;">{{ notification.message }}</div>
                                    <div style="font-size: 0.8rem; color: var(--gray);">{{ notification.timestamp.strftime('%Y-%m-%d %H:%M') }}</div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <div style="text-align: center; padding: 40px 20px; color: var(--gray);">
                            <i class="far fa-bell-slash" style="font-size: 3rem; margin-bottom: 15px; opacity: 0.5;"></i>
                            <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹</p>
                        </div>
                    {% endif %}
                </div>
            </div>

            <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… ÙˆØ§Ù„Ø£ÙˆØ²Ø§Ù† -->
            <div style="display: flex; flex-direction: column; gap: 25px;">
                <div class="card" style="background: white; border-radius: var(--border-radius); padding: 20px; box-shadow: var(--shadow);">
                    <h3 style="color: var(--dark); margin-bottom: 15px;"><i class="fas fa-info-circle"></i> Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</h3>
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <div style="display: flex; justify-content: space-between;"><span style="color: var(--gray);">Ø§Ù„Ø¥ØµØ¯Ø§Ø±:</span><span style="font-weight: 600; color: var(--secondary);">3.5.0 Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</span></div>
                        <div style="display: flex; justify-content: space-between;"><span style="color: var(--gray);">ÙØ§ØµÙ„ Ø§Ù„ØªØ­Ø¯ÙŠØ«:</span><span style="font-weight: 600;">3 Ø¯Ù‚Ø§Ø¦Ù‚</span></div>
                        <div style="display: flex; justify-content: space-between;"><span style="color: var(--gray);">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª:</span><span style="font-weight: 600; color: var(--purple);">{{ indicator_weights|length }} Ù…Ø¤Ø´Ø±Ø§Øª</span></div>
                        <div style="display: flex; justify-content: space-between;"><span style="color: var(--gray);">Ø­Ø§Ù„Ø© API:</span><span style="font-weight: 600; color: var(--success);">Ù…ØªØµÙ„</span></div>
                    </div>
                </div>

                <div class="card" style="background: white; border-radius: var(--border-radius); padding: 20px; box-shadow: var(--shadow);">
                    <h3 style="color: var(--dark); margin-bottom: 15px;"><i class="fas fa-balance-scale"></i> Ø£ÙˆØ²Ø§Ù† Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª</h3>
                    <div style="display: flex; flex-direction: column; gap: 8px;">
                        {% for indicator, weight in indicator_weights.items() %}
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 5px 0;">
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <div style="width: 12px; height: 12px; border-radius: 50%; background: {{ get_indicator_color(indicator) }};"></div>
                                <span style="font-size: 0.9rem;">{{ get_indicator_display_name(indicator) }}</span>
                            </div>
                            <span style="font-weight: 600; color: var(--primary);">{{ "%.0f"|format(weight * 100) }}%</span>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>

        <!-- ========== Ø§Ù„ØªØ°ÙŠÙŠÙ„ ========== -->
        <footer>
            <p>ğŸš€ Crypto Signal Analyzer v3.5 â€“ Ø¹Ø±Ø¶ Ù…ÙˆØ³Ø¹ Ù…ØªØ¬Ø§ÙˆØ¨ Ù„Ø£ÙƒØ«Ø± Ù…Ù† 100 Ø¹Ù…Ù„Ø©</p>
            <div class="disclaimer">
                <p style="margin: 0; font-size: 0.8rem;">
                    <i class="fas fa-exclamation-triangle"></i>
                    Ù‡Ø°Ø§ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù„Ø£ØºØ±Ø§Ø¶ ØªØ¹Ù„ÙŠÙ…ÙŠØ© ÙˆØªØ­Ù„ÙŠÙ„ÙŠØ© ÙÙ‚Ø·. Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª ØªØ³ØªÙ†Ø¯ Ø¥Ù„Ù‰ 7 Ù…Ø¤Ø´Ø±Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø© ÙˆÙ„ÙŠØ³Øª Ù†ØµÙŠØ­Ø© Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠØ©.
                </p>
            </div>
        </footer>
    </div>

    <!-- ========== Ù†Ø§ÙØ°Ø© Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© ========== -->
    <div id="coinDetailModal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal()"><i class="fas fa-times"></i></button>
            <div id="modalContent"></div>
        </div>
    </div>

    <!-- ========== Ø¥Ø´Ø¹Ø§Ø± Toast ========== -->
    <div id="notificationToast" class="notification-toast">
        <div class="notification-toast-icon"><i class="fas fa-check-circle"></i></div>
        <div class="notification-toast-message"></div>
    </div>

    <script>
        // ========== Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙ‡ÙŠØ¦Ø© ==========
        const AppConfig = {
            UPDATE_INTERVAL: 180,
            SIGNAL_THRESHOLDS: { strong_buy: 78, buy: 62, neutral_high: 56, neutral_low: 44, sell: 38, strong_sell: 22 }
        };

        let coinsData = [];
        let filteredData = [];
        let currentPage = 1;
        let perPage = 25;
        let sortColumn = 0;
        let sortDirection = 'asc';

        // ========== ØªØ¬Ù‡ÙŠØ² Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ù…Ù† Ø§Ù„Ù‚Ø§Ù„Ø¨ ==========
        {% if coins %}
        coinsData = [
            {% for coin in coins %}
            {
                symbol: "{{ coin.symbol }}",
                name: "{{ coin.name }}",
                price: {{ coin.price_usdt }},
                price_change_24h: {{ coin.price_change_24h or 0 }},
                signal_percentage: {{ coin.total_percentage }},
                signal_type: "{{ coin.signal_type }}",
                signal_color: "{{ coin.signal_color }}",
                formatted_price: "{{ coin.formatted_price }}",
                formatted_24h_change: "{{ coin.formatted_24h_change or '0.00%' }}",
                indicators: {{ coin.indicators|tojson }}
            },
            {% endfor %}
        ];
        {% endif %}

        // ========== Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¬Ø¯ÙˆÙ„ (ÙƒÙ…Ø§ Ù‡ÙŠ) ==========
        function renderTable() { /* ... ÙŠØ¨Ù‚Ù‰ Ø¯ÙˆÙ† ØªØºÙŠÙŠØ± ... */ }
        function filterData() { /* ... */ }
        function sortData() { /* ... */ }
        function paginateData() { /* ... */ }
        function renderPagination(totalPages) { /* ... */ }
        function changePage(page) { currentPage = page; paginateData(); }
        function changePerPage() { perPage = parseInt(document.getElementById('perPageSelect').value); currentPage = 1; paginateData(); }
        function sortTable(col) { if (sortColumn === col) sortDirection = sortDirection === 'asc' ? 'desc' : 'asc'; else { sortColumn = col; sortDirection = 'asc'; } sortData(); paginateData(); }
        function filterTable() { currentPage = 1; renderTable(); }

        // ========== Ù…Ø¤Ø´Ø± Ù†Ø¶Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØªÙˆØµÙŠØ§Øª Ø§Ù„ØªØ­Ø¯ÙŠØ« ==========
        function getMinutesSinceLastUpdate() {
            const lastUpdateText = document.getElementById('last-update-text')?.innerText;
            if (!lastUpdateText || lastUpdateText === 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...') return null;
            // Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ® (ÙŠØ¯Ø¹Ù… ØªÙ†Ø³ÙŠÙ‚ YYYY-MM-DD HH:MM)
            try {
                const parts = lastUpdateText.split(' ');
                if (parts.length < 2) return null;
                const dateStr = parts[0] + 'T' + parts[1] + ':00'; // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø«ÙˆØ§Ù†ÙŠ
                const date = new Date(dateStr);
                if (isNaN(date)) return null;
                return Math.floor((new Date() - date) / 60000);
            } catch(e) {
                return null;
            }
        }

        function updateFreshnessIndicator() {
            const dot = document.getElementById('freshnessDot');
            const staleWarning = document.getElementById('staleWarning');
            const updateRecommendation = document.getElementById('updateRecommendation');
            if (!dot) return;
            
            const minutes = getMinutesSinceLastUpdate();
            // Ø¥Ø²Ø§Ù„Ø© ÙƒÙ„ Ø§Ù„ÙØ¦Ø§Øª Ø£ÙˆÙ„Ø§Ù‹
            dot.className = 'freshness-dot';
            if (minutes === null) {
                dot.style.background = '#aaa';
                if (staleWarning) staleWarning.style.display = 'none';
                if (updateRecommendation) updateRecommendation.style.display = 'none';
                return;
            }

            dot.classList.add('freshness-dot');
            let tooltipText = '';
            if (minutes < 5) {
                dot.classList.add('recent');
                tooltipText = `Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« Ù…Ù†Ø° ${minutes} Ø¯Ù‚Ø§Ø¦Ù‚ - Ø­Ø¯ÙŠØ«`;
                if (staleWarning) staleWarning.style.display = 'none';
                if (updateRecommendation) updateRecommendation.style.display = 'none';
            } else if (minutes < 15) {
                dot.classList.add('stale');
                tooltipText = `Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« Ù…Ù†Ø° ${minutes} Ø¯Ù‚Ø§Ø¦Ù‚ - Ù‚Ø¯ÙŠÙ… Ù†ÙˆØ¹Ø§Ù‹ Ù…Ø§`;
                if (staleWarning) staleWarning.style.display = 'none';
                if (updateRecommendation) updateRecommendation.style.display = 'none';
            } else {
                dot.classList.add('very-stale');
                tooltipText = `Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« Ù…Ù†Ø° ${minutes} Ø¯Ù‚Ø§Ø¦Ù‚ - Ù‚Ø¯ÙŠÙ… Ø¬Ø¯Ø§Ù‹ØŒ ÙŠÙˆØµÙ‰ Ø¨Ø§Ù„ØªØ­Ø¯ÙŠØ«`;
                if (staleWarning) staleWarning.style.display = 'inline';
                if (updateRecommendation) updateRecommendation.style.display = 'inline-flex';
            }
            dot.title = tooltipText;
        }

        // ========== Ø²Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙŠØ¯ÙˆÙŠ Ø§Ù„Ù…Ø­Ø³Ù‘Ù† (Ù…Ø¹ ØªÙØ§Ø¹Ù„ Ø¨ØµØ±ÙŠ ÙƒØ§Ù…Ù„) ==========
        function manualUpdate() {
            const btn = document.getElementById('updateBtn');
            if (btn.classList.contains('loading')) return; // Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø±
            
            // Ø­ÙØ¸ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø£ØµÙ„ÙŠ
            const originalHtml = btn.innerHTML;
            
            // ØªÙØ¹ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
            btn.classList.add('loading');
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-pulse"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ«...';
            
            // Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ø¯ÙŠØ«
            showNotification('Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...', 'info');
            
            // Ù…Ø­Ø§ÙƒØ§Ø© ÙˆÙ‚Øª Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© (1.5 Ø«Ø§Ù†ÙŠØ©)
            setTimeout(() => {
                // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø²Ø± Ù„Ø­Ø§Ù„ØªÙ‡ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ©
                btn.classList.remove('loading');
                btn.disabled = false;
                btn.innerHTML = originalHtml;
                
                // ØªØ­Ø¯ÙŠØ« Ù†Øµ Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« Ø¥Ù„Ù‰ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ (ØªØ£Ø«ÙŠØ± Ù…Ø±Ø¦ÙŠ ÙÙˆØ±ÙŠ)
                const now = new Date();
                const year = now.getFullYear();
                const month = String(now.getMonth() + 1).padStart(2, '0');
                const day = String(now.getDate()).padStart(2, '0');
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                const formattedNow = `${year}-${month}-${day} ${hours}:${minutes}`;
                document.getElementById('last-update-text').innerText = formattedNow;
                
                // ØªØ­Ø¯ÙŠØ« Ù…Ø¤Ø´Ø± Ø§Ù„Ù†Ø¶Ø§Ø±Ø© ÙˆØªÙˆØµÙŠØ§Øª Ø§Ù„ØªØ­Ø¯ÙŠØ«
                updateFreshnessIndicator();
                
                // Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù†Ø¬Ø§Ø­
                showNotification('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
            }, 1500);
        }

        // ========== Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª (ÙŠØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡Ùˆ) ==========
        function refreshNotifications() { location.reload(); }

        // ========== Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Toast ==========
        function showNotification(message, type = 'success') {
            const toast = document.getElementById('notificationToast');
            toast.querySelector('.notification-toast-message').innerHTML = message;
            toast.className = 'notification-toast ' + type;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 4000);
        }

        // ========== Ù…Ø¤Ù‚Øª Ø§Ù„ØªØ­Ø¯ÙŠØ« (ÙƒÙ…Ø§ Ù‡Ùˆ) ==========
        let timerInterval;
        function startUpdateTimer() {
            let seconds = AppConfig.UPDATE_INTERVAL;
            const timerEl = document.getElementById('update-timer');
            timerInterval = setInterval(() => {
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                timerEl.textContent = `Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ§Ù„ÙŠ Ø®Ù„Ø§Ù„: ${mins}:${secs < 10 ? '0' : ''}${secs}`;
                if (seconds === 0) {
                    clearInterval(timerInterval);
                    timerEl.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ«...';
                    // ÙŠÙ…ÙƒÙ† ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù‡Ù†Ø§ Ø¥Ø°Ø§ Ø±ØºØ¨Øª
                }
                seconds--;
            }, 1000);
        }

        // ========== Ù…Ø¤Ø´Ø± Ø§Ù„Ø®ÙˆÙ ==========
        function updateFearGreedMarker() {
            const marker = document.getElementById('fgi-marker');
            if (marker) marker.style.left = '{{ stats.fear_greed_index }}%';
        }

        // ========== Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ ==========
        async function initChart() { /* ... ÙŠØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡Ùˆ ... */ }

        // ========== Ù†Ø§ÙØ°Ø© Ø§Ù„ØªÙØ§ØµÙŠÙ„ ==========
        function showCoinDetails(symbol) { /* ... ÙŠØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡Ùˆ ... */ }
        function closeModal() { document.getElementById('coinDetailModal').classList.remove('show'); }

        // ========== ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø© ==========
        document.addEventListener('DOMContentLoaded', function() {
            renderTable();
            startUpdateTimer();
            updateFearGreedMarker();
            initChart();
            updateFreshnessIndicator();
            
            // ØªØ­Ø¯ÙŠØ« Ù…Ø¤Ø´Ø± Ø§Ù„Ù†Ø¶Ø§Ø±Ø© ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©
            setInterval(updateFreshnessIndicator, 60000);
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ø¨Ø§Ù„Ø¶ØºØ· Ø®Ø§Ø±Ø¬Ù‡Ø§
            window.onclick = function(event) {
                const modal = document.getElementById('coinDetailModal');
                if (event.target === modal) modal.classList.remove('show');
            };
        });

        // ========== ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù…Ø¤Ù‚ØªØ§Øª ==========
        window.addEventListener('beforeunload', function() {
            if (timerInterval) clearInterval(timerInterval);
        });
    </script>
</body>
</html>
